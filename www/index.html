<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ZIM - Code Creativity</title>
    <script src="https://zimjs.org/cdn/1.2.4/createjs.js"></script>
    <script src="https://zimjs.org/cdn/10.8.0/zim.js"></script>
    <script>
      // https://zimjs.com - JavaScript Canvas Framework - Code Creativity!

      const assets = ["tree.png", "car.png"];
      const path = "assets/";
      const frame = new Frame("full", null, null, light, dark, assets, path);

      frame.on("ready", () => {
        const stage = frame.stage;
        let stageW = frame.width;
        let stageH = frame.height;

        // put your code here

        const layoutManager = new LayoutManager();

        // PAGE 1
        const page1 = new Container(stageW, stageH).addTo();

        const content = new Container(600, 800).addTo(page1);

        var tree = frame.asset("tree.png").addTo().sca(0.15);
        var car = frame.asset("car.png").addTo().sca(0.15);

        // backing
        const tiles = new Tile(new Rectangle(null, null, dark), 4, 6, 5, 5)
          .cur()
          //   .scaleTo(content, 90, 90)
          .center(content);

        // car
        const cars = new Tile(car.alp(0), 4, 6, 5, 5)
          .cur()
          //   .scaleTo(content, 90, 90)
          .center(content);

        // trees
        const trees = new Tile(tree.alp(0), 4, 6, 5, 5)
          .cur()
          //   .scaleTo(content, 90, 90)
          .center(content);

        // add trees on click

        tiles.on("mousedown", function (e) {
          const index = trees.hitTestGrid(
            trees.width,
            trees.height,
            4,
            6,
            frame.mouseX,
            frame.mouseY,
            0,
            0,
            5,
            5
          );
          //   zog(index);

          if (index != null) {
            trees.getChildAt(index).alp(1);
            stage.update();
          }
        });

        // add trees on top of cars

        cars.on("mousedown", function (e) {
          var index = trees.hitTestGrid(
            trees.width,
            trees.height,
            4,
            6,
            frame.mouseX,
            frame.mouseY,
            0,
            0,
            5,
            5
          );
          //   zog(index);

          if (index != null) {
            trees.getChildAt(index).alp(1);
            stage.update();
          }
        });

        interval(500, function () {
          var index = rand(tiles.numChildren - 1);
          zog(index);
          if (index !== car) {
            cars.getChildAt(index).alp(1);
          } else {
          }
          stage.update();
        });

        // var indexes = shuffle([index[0], index[1], index[1]]);
        // zog(indexes);

        // this will be randomized each time it is run

        // cars on an interval

        // tiles.loop(function (tile, i) {
        //   interval(1000, function () {
        //     tiles.getChildAt(1).alp(1);
        //   });
        // });

        // interval(1000, function () {
        //   tiles.loop(function (tile) {
        //     tile.numChildren;
        //   });
        //   stage.update();
        // });

        layoutManager.add(
          new Layout(
            page1,
            [{ object: content, marginTop: 5 }],
            5,
            white,
            true,
            new Shape(),
            stage
          )
        );

        // PAGE 2

        // PAGE 3

        layoutManager.dispose();
        frame.on("resize", () => {
          stageW = frame.width;
          stageH = frame.height;
          layoutManager.resize();
        });

        stage.update();
      });
    </script>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
  </head>
  <body></body>
</html>
